# 開発管理ドキュメント

## 1. 開発フロー

### 1.1 ブランチ戦略
**注：詳細はCLAUDE.mdの「Branch Strategy」セクションを参照**

### 1.2 コミットメッセージ規約
**注：詳細はCLAUDE.mdの「Commit Message Convention」セクションを参照**

### 1.3 PRレビュー基準
1. コーディング規約の遵守
2. テストの網羅性
3. パフォーマンスへの影響
4. セキュリティ上の考慮
5. ドキュメントの更新

### 1.4 GitHub Issue管理
#### Issue作成ルール
- **タイトル形式**: `[種別] 概要`
  - 種別: `feature`, `bug`, `docs`, `refactor`, `test`, `chore`
- **説明項目**:
  1. 目的・背景
  2. 実装内容・変更点
  3. 受け入れ基準
  4. 関連Issue/PR

#### Issue管理プロセス
1. **Issue作成**
   - 新機能・改善案の提案
   - バグ報告
   - ドキュメント更新の提案

2. **ラベル付け**
   - `priority`: 優先度（high, medium, low）
   - `status`: 状態（todo, in-progress, review, done）
   - `type`: 種別（feature, bug, docs, etc）
   - `scope`: 影響範囲（frontend, backend, infra, etc）

3. **マイルストーン管理**
   - 開発フェーズごとにマイルストーンを作成
   - 期限と目標を明確に設定
   - 進捗を定期的に更新

4. **プロジェクトボード活用**
   - カンバンボード形式で管理
   - ステータスの可視化
   - ボトルネックの早期発見

### 1.5 GitHub Flow
1. **Issue作成**
   - 実装内容の明確化
   - タスクの分割と見積もり

2. **ブランチ作成**
   - 命名規則: `feature/issue-{番号}-{概要}`
   - Issueと紐付け

3. **実装・コミット**
   - atomic commitの原則
   - コミットメッセージ規約の遵守

4. **Pull Request作成**
   - テンプレートに従って記述
   - レビュアーのアサイン
   - Issueとの紐付け

5. **コードレビュー**
   - PRレビュー基準に基づくレビュー
   - CI/CDチェックの確認
   - フィードバックの反映

6. **マージ・デプロイ**
   - Squash and mergeを推奨
   - 自動デプロイの実行
   - Issueのクローズ

### 1.6 PRテンプレート
```markdown
## 概要
- 変更内容の要約
- 関連するIssue番号

## 変更内容
- [ ] 具体的な変更点1
- [ ] 具体的な変更点2

## 動作確認
- [ ] テストの追加・実行
- [ ] ローカルでの動作確認
- [ ] レビュー項目の確認

## スクリーンショット
（UI変更がある場合）

## その他
- 補足事項
- レビュアーへの注意点
```

## 2. 開発フェーズ

### Phase 1: 基盤構築
- [x] プロジェクト初期化
- [x] 基本設計書作成
- [x] 開発環境構築
- [x] CIパイプライン構築
- [x] GitHubリポジトリセットアップ
  - [x] Issue・PRテンプレート作成
  - [x] プロジェクトボード設定
  - [x] ブランチ保護ルール設定
  - [x] CIワークフロー設定

### Phase 2: コア機能実装
- [x] MarkdownパーサーとMDsveX設定
- [x] 基本レイアウト実装
- [x] 記事一覧表示機能
- [x] 記事詳細表示機能

### Phase 3: バックエンド基盤構築
- [ ] データベース設定（ORM導入、スキーマ定義）
- [ ] 認証機能実装（ログイン/ログアウト）
- [ ] 記事CRUD API実装
- [ ] カテゴリ管理API実装

### Phase 4: 管理画面UI実装
- [ ] 管理画面共通レイアウト実装
- [ ] 記事管理UI実装（一覧、新規作成、編集）
- [ ] カテゴリ管理UI実装

### Phase 5: 公開側機能のDB連携
- [ ] 記事一覧ページのDB連携
- [ ] 記事詳細ページのDB連携
- [ ] TOPページの再構築

### Phase 6: UI/UX改善
- [ ] レスポンシブデザイン対応
- [ ] ダークモード実装
- [ ] アニメーション追加
- [ ] アクセシビリティ対応

### Phase 7: SEO/パフォーマンス最適化
- [ ] メタタグ最適化
- [ ] OGP対応
- [ ] パフォーマンス改善
- [ ] Lighthouse スコア最適化

### Phase 8: 分析・モニタリング
- [ ] Google Analytics設定
- [ ] エラー監視設定
- [ ] パフォーマンスモニタリング設定

## 3. 開発環境セットアップ

### 3.1 必要なツール
- Node.js (v20.x以上)
- pnpm
- Git
- Cursor IDE
- VSCode（オプション）

### 3.2 初期セットアップ手順
```bash
# リポジトリのクローン
git clone [repository-url]
cd note

# 依存関係のインストール
pnpm install

# 開発サーバーの起動
pnpm dev
```

### 3.3 環境変数設定
```env
# .env.local
DATABASE_URL="file:./dev.db"
ANALYTICS_ID="G-XXXXXXXXXX"
```

## 4. テスト戦略

### 4.1 テストレベル
1. **ユニットテスト**
   - コンポーネント単体テスト
   - ユーティリティ関数テスト

2. **統合テスト**
   - ページ遷移テスト
   - API統合テスト

3. **E2Eテスト**
   - ユーザーフロー検証
   - クロスブラウザテスト

### 4.2 テストツール
- Vitest: ユニットテスト
- Playwright: E2Eテスト
- Testing Library: コンポーネントテスト

## 5. デプロイメントフロー

### 5.1 開発環境（develop）
1. feature ブランチから develop へのマージ
2. Vercel Preview Deployment による自動デプロイ
3. 動作確認とテスト

### 5.2 本番環境（main）
1. develop から main へのマージ
2. Vercel Production への自動デプロイ
3. 本番環境での最終確認

## 6. モニタリング計画

### 6.1 パフォーマンスモニタリング
- Vercel Analytics
- Web Vitals
- Lighthouse CI

### 6.2 エラーモニタリング
- Sentry
- ブラウザコンソールログ
- サーバーサイドログ

### 6.3 アクセス解析
- Google Analytics 4
- ユーザー行動分析
- コンバージョン計測

## 7. 保守・運用計画

### 7.1 定期メンテナンス
- 週次: 依存パッケージの更新確認
- 月次: セキュリティアップデート
- 四半期: パフォーマンス最適化

### 7.2 バックアップ計画
- GitHubでのソースコード管理
- データベースの定期バックアップ
- コンテンツの外部保存

### 7.3 インシデント対応
1. 問題の検知と切り分け
2. 一時対応（可能な場合）
3. 根本原因の分析
4. 恒久対策の実施
5. 再発防止策の文書化

## 8. システム構築フロー

### 8.1 基本原則
- 段階的な設計と実装のアプローチ
- 各フェーズの完了条件の明確化
- 生成AIの出力品質の安定化
- 全体設計との整合性の維持

### 8.2 構築ステップ

#### Step 1: 全体設計
1. **システム全体の設計**
   - `design.md`の作成・更新
   - アーキテクチャの定義
   - 技術スタックの選定
   - 非機能要件の定義

2. **設計レビュー**
   - 技術的な実現可能性の確認
   - 非機能要件の妥当性確認
   - セキュリティ要件の確認
   - 完了条件：レビュー指摘事項の解消

#### Step 2: フェーズ分解
1. **フェーズの定義**
   - 各フェーズの目標設定
   - 依存関係の明確化
   - リスクの特定

2. **フェーズの評価基準**
   - 受け入れ基準の設定
   - テスト基準の定義
   - パフォーマンス基準の設定

#### Step 3: フェーズ詳細設計
1. **フェーズNの詳細設計**
   - 具体的な実装仕様
   - インターフェース定義
   - データモデル定義
   - テスト計画
   - **ドキュメント化**: `doc/templates/design_template.md` をコピーし、設計内容を `/doc/designs/phase-N/XX_機能名.md` としてファイルに記録する

2. **設計レビュー**
   - 全体設計との整合性確認
   - 技術的な実現可能性の確認
   - セキュリティ要件の確認

#### Step 4: Issue分解
1. **Issue作成**
   - 機能単位での分割
   - 依存関係の明確化
   - 優先順位の設定
   - **定義ファイル**: `.github/ISSUE_TEMPLATE` 内の適切なテンプレートをコピーし、Issue作成前に `/doc/issues/phase-N/issue_機能名.md` として定義ファイルを記録する。

2. **Issue定義**
   - 具体的な実装タスク
   - 受け入れ基準
   - テスト項目
   - レビュー基準

#### Step 5: GitHub Issueへの反映
1. **Issueの自動作成**
   - AIアシスタントは、`/doc/issues/phase-N/`配下に作成された定義ファイルをもとに、GitHub CLIを使用して自動でIssueを作成する。

2. **ドキュメントの記録**
   - Issue作成に使用した設計書（`/doc/designs/`）とIssue定義書（`/doc/issues/`）は、トレーサビリティ確保のため、Gitリポジトリにコミット・プッシュする。

#### Step 6: 実装とレビュー
1. **実装**
   - 生成AIを用いた実装
   - コードレビュー
   - テスト実施
   - ドキュメント更新

2. **品質確認**
   - 単体テストの実施
   - 統合テストの実施
   - パフォーマンステスト
   - セキュリティテスト

#### Step 7: フェーズ完了確認
1. **完了条件の確認**
   - 全Issueの完了
   - テストの合格
   - パフォーマンス基準の達成
   - ドキュメントの更新

2. **次フェーズの準備**
   - 学習事項の記録
   - リスクの再評価
   - 次フェーズの詳細設計着手

### 8.3 品質管理方針

#### 8.3.1 生成AI利用ガイドライン
1. **出力の検証**
   - コードレビューの徹底
   - テストカバレッジの確保
   - 静的解析の実施

2. **プロンプト管理**
   - 効果的なプロンプトの記録
   - プロンプトの改善・最適化
   - コンテキストの維持方法

#### 8.3.2 品質メトリクス
1. **コード品質**
   - テストカバレッジ: 80%以上
   - Sonar品質ゲート
   - パフォーマンス基準

2. **ドキュメント品質**
   - 設計書の更新状況
   - API仕様書の完備
   - コメントの充実度

### 8.4 リスク管理

#### 8.4.1 生成AI特有のリスク
1. **一貫性の欠如**
   - 全体設計との整合性チェック
   - コードスタイルの統一
   - 命名規則の遵守

2. **セキュリティリスク**
   - 脆弱性スキャン
   - セキュリティレビュー
   - 依存関係の検証

#### 8.4.2 対策
1. **レビュー強化**
   - 複数視点でのレビュー
   - チェックリストの活用
   - 自動化ツールの活用

2. **モニタリング**
   - 品質メトリクスの監視
   - パフォーマンスの監視
   - セキュリティ監視

# 変更履歴
- 2024-06-05: 初版作成
- 2024-06-05: GitHub Issue管理とGitHub Flowの詳細を追加
- 2024-06-05: システム構築フローを追加
- 2024-06-18: Issue定義ファイルからGitHub Issueを自動作成するフローを追加 